<!DOCTYPE html>
<!-- saved from url=(0050)https://www.account.ford.com/etc/fd/fma/sguid.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>SSO</title>
  </head>
  <body>
    <h1>FMA S-GUID</h1>
    <p id="iframe-message">{"action":"addGUID","app_ID":"CCCA9FB8-B941-46AD-A89F-F9D9D699DD68","gdprConsentRequired":false,"userCookiePreferences":{"strictly necessary":true,"performance":false,"functionality":false,"targeting":false},"guestUserGuid":"f5b797b4-177f-39ae-921a-522a819585f9"}</p>
    <script>
      // Polyfills

      if (typeof Object.assign !== 'function') {
        // Must be writable: true, enumerable: false, configurable: true
        Object.defineProperty(Object, 'assign', {
          value: function assign(target, varArgs) {
            // .length of function is 2
            'use strict';
            if (target === null || target === undefined) {
              throw new TypeError('Cannot convert undefined or null to object');
            }

            var to = Object(target);

            for (var index = 1; index < arguments.length; index++) {
              var nextSource = arguments[index];

              if (nextSource !== null && nextSource !== undefined) {
                for (var nextKey in nextSource) {
                  // Avoid bugs when hasOwnProperty is shadowed
                  if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                    to[nextKey] = nextSource[nextKey];
                  }
                }
              }
            }
            return to;
          },
          writable: true,
          configurable: true,
        });
      }

      const messageHolder = document.getElementById('iframe-message');
      function receiveMessage(event) {
        messageHolder.innerHTML = event.data;

        const transmission = event.data ? JSON.parse(event.data) : null;

        // Only Set local storage if cookie consent is NOT enabled OR
        // If cookie consent is enabled AND the cookie group is accepted by user
        function setLocalStorage(name, value, gdprConsentRequired, cookieGroup) {
          const params = transmission.userCookiePreferences;
          if (
            !gdprConsentRequired
            || params[cookieGroup] === 'true'
            || params[cookieGroup] === true
          ) {
            window.localStorage.setItem(name, value);
          }
        }

        // Set guest user GUID
        if (
          transmission &&
          transmission.action === 'addGUID' &&
          transmission.app_ID &&
          transmission.guestUserGuid
        ) {
          const existingGUIDs = window.localStorage.getItem('guestUserGUIDs');
          let updatedGUIDs;

          const guidForThisID = existingGUIDs
            ? JSON.parse(existingGUIDs)[transmission.app_ID]
            : null;

          if (!guidForThisID) {
            let newGUID = {};
            newGUID[transmission.app_ID] = transmission.guestUserGuid;

            if (existingGUIDs) {
              updatedGUIDs = Object.assign({}, JSON.parse(existingGUIDs), newGUID);
            } else {
              updatedGUIDs = newGUID;
            }

            setLocalStorage(
              'guestUserGUIDs',
              JSON.stringify(updatedGUIDs),
              transmission.gdprConsentRequired,
              'targeting'
            );
          }
        }
      }

      window.addEventListener('message', function(event) {
        receiveMessage(event);
      });
    </script>
  

</body></html>